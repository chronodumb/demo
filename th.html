<html>
<head>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script>
        var td = [];
        var rd = [];
        var gd = [];
        var dd = [];
        var hh = [];

        var ts = [
            {type:"t", name:"a1", give:1, take:6},
            {type:"t", name:"a2", give:1, take:5},
            {type:"t", name:"b1", give:2, take:4},
            {type:"t", name:"b2", give:2, take:3},
            {type:"t", name:"c1", give:3, take:2},
            {type:"t", name:"c2", give:3, take:1},
            {type:"t", name:"d1", give:4, take:6},
            {type:"t", name:"d2", give:4, take:5},
            {type:"t", name:"e1", give:5, take:4},
            {type:"t", name:"e2", give:5, take:3},
            {type:"t", name:"f1", give:6, take:2},
            {type:"t", name:"f2", give:6, take:1},
        ];

        var rs = [
            {type:"r", name:"r1", give:1},
            {type:"r", name:"r2", give:2},
            {type:"r", name:"r3", give:3},
            {type:"r", name:"r4", give:4},
            {type:"r", name:"r5", give:5},
            {type:"r", name:"r6", give:6},
        ];

        var gs= [
            {lv:1, type:"g", name:"GA1",up:"GA2",take:[1,2]},
            {lv:2, type:"g", name:"GA2",up:"GA3",take:[1,3]},
            {lv:3, type:"g", name:"GA3",up:"GA4",take:[1,4,3]},
            {lv:4, type:"g", name:"GA4",up:"GA5",take:[1,5,4]},
            {lv:5, type:"g", name:"GA5",up:"end",take:[1,6,5,4]},

            {lv:1, type:"g", name:"GB1",up:"GB2",take:[2,5]},
            {lv:2, type:"g", name:"GB2",up:"GB3",take:[2,3]},
            {lv:3, type:"g", name:"GB3",up:"GB4",take:[2,3,1]},
            {lv:4, type:"g", name:"GB4",up:"GB5",take:[2,3,4]},
            {lv:5, type:"g", name:"GB5",up:"end",take:[2,5,6,4]},

            {lv:1, type:"g", name:"GC1",up:"GB2",take:[3,5]},
            {lv:2, type:"g", name:"GC2",up:"GB3",take:[3,6]},
            {lv:3, type:"g", name:"GC3",up:"GB4",take:[3,6,4]},
            {lv:4, type:"g", name:"GC4",up:"GB5",take:[3,3,4]},
            {lv:5, type:"g", name:"GC5",up:"end",take:[3,5,4,4]},

            {lv:1, type:"g", name:"GD1",up:"GB2",take:[4,3]},
            {lv:2, type:"g", name:"GD2",up:"GB3",take:[4,6]},
            {lv:3, type:"g", name:"GD3",up:"GB4",take:[4,3,2]},
            {lv:4, type:"g", name:"GD4",up:"GB5",take:[4,2,4]},
            {lv:5, type:"g", name:"GD5",up:"end",take:[4,2,1,1]},

            {lv:1, type:"g", name:"GE1",up:"GB2",take:[5,5]},
            {lv:2, type:"g", name:"GE2",up:"GB3",take:[5,3]},
            {lv:3, type:"g", name:"GE3",up:"GB4",take:[5,2,2]},
            {lv:4, type:"g", name:"GE4",up:"GB5",take:[5,4,3]},
            {lv:5, type:"g", name:"GE5",up:"end",take:[5,2,1,4]},

            {lv:1, type:"g", name:"GF1",up:"GB2",take:[6,1]},
            {lv:2, type:"g", name:"GF2",up:"GB3",take:[6,3]},
            {lv:3, type:"g", name:"GF3",up:"GB4",take:[6,5,2]},
            {lv:4, type:"g", name:"GF4",up:"GB5",take:[6,2,3]},
            {lv:5, type:"g", name:"GF5",up:"end",take:[6,2,3,4]},
        ];

        var ss = [
            {type:"s", name: "ss1", take:[1], takeOr:[0,0] },
            {type:"s", name: "ss2", take:[0]},
        ]

        var cc = null;

        $(document).ready(function(){
            start()
        })

        function start(){
            $(".start").hide()
            $(".tb").show()
            assemble();

        }

        function assemble(){
            //Re-init
            td = [];
            rd = [];
            gd = [];
            dd = [];
            hh = [];

            let nts = JSON.parse(JSON.stringify(ts));

            //Exclude 2 then ts then add 10 to td
            (nts.splice(Math.floor(Math.random()*nts.length),1)[0]);
            (nts.splice(Math.floor(Math.random()*nts.length),1)[0]);

            td.push.apply(td,nts);

            //Add 1 copy each rs to td
            let nrs = JSON.parse(JSON.stringify(rs));
            td.push.apply(td,nrs);

            //put the rest to rd
            rd.push.apply(rd,rs);
            rd.push.apply(rd,rs);
            rd.push.apply(rd,rs);
            rd.push.apply(rd,rs);
            rd.push.apply(rd,rs);


            //Add lv 1 gs to td
            let ngs = JSON.parse(JSON.stringify(gs));
            for (i in ngs){
                if (ngs[i].lv == 1){
                    td.push(ngs.splice(i,1)[0]);
                }
            }

            gd.push.apply(gd,ngs);


            //Add the 2 xtras
            td.push.apply(td,ss);

            console.log(td);


            //draw 4
            shuffle(rd);
            hh.push(draw(rd));
            hh.push(draw(rd));
            hh.push(draw(rd));
            hh.push(draw(rd));


            console.log(hh);
            console.log(rd);

            render();

            shuffle(td);

            console.log(td);

        }

        function doTurn(){
            if (td.length < 3){
                td.push.apply(td,dd);
                dd = [];
                shuffle(td);
            }

            //Draw 3... flip 3rd...
            dd.push(draw(td));
            dd.push(draw(td));
            cc = draw(td);
            dd.push(cc);


            render();

        }

        function render(){
            $(".ctr").html(td.length);

            if (cc){
                console.log(cc);

                let opt1="",opt2="<a onclick='doTurn()'>SKIP</a>";
                if (cc.type=="r"){
                    opt1 = "<a onclick='take()'>TAKE</a>"
                }

                $(".td").html("<div class='c'>"
                    + cc.name
                    + opt1
                    + opt2
                    + "</div>");
            }

            var hr = "";
            for (i in hh){
                hr += "<div class='c'>" + hh[i].name + "</div> "
            }
            $(".hh").html(hr);

        }

        function take(){
            console.log(cc);
            hh.push(cc);
            render();
            doTurn();
        }

        function doCC(cc){
            console.log("doCC")
        }

        function draw(a){
            return a.splice(Math.floor(Math.random()*a.length),1)[0];
        }

        function shuffle(array) {
            for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
        }

    </script>
    <style>
        .area { width: 300px; text-align: center}
        .c {border: 1px solid; cursor: pointer; width: 30px; height: 60px; background-color: white; display: inline-block}
        .c:hover {border-color: red}
        .disable {pointer-events: none; filter:grayscale(1)}
    </style>
</head>
<body>
    <input class="start" type="button" value="start" onclick="start()"/>

    <div class="tb">
        <div class="area">
            <div class="td">
                <div class="c" onclick="doTurn()">draw</div>
            </div>
            <div class="ctr">24</div>
        </div>
        <br/>
        <div class="hh area">


        </div>

    </div>

</body>
</html>